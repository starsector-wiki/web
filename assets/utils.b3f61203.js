import{W as c,a1 as M,a2 as I}from"./index.2981bf06.js";function x(t){return parseFloat(t.toFixed(2))}function D(t){return JSON.stringify(t,b,2)}function b(t,s){return s instanceof Map?Array.from(s.entries()):s}async function E(t,s=!1){const l=s?t.hardPointUnderSprite:t.turretUnderSprite,f=s?t.hardPointGunSprite:t.turretGunSprite,h=s?t.hardPointSprite:t.turretSprite,p=[c.getImage(h)];l&&p.push(c.getImage(l)),f&&p.push(c.getImage(f)),t.projSpriteName&&p.push(c.getImage(t.projSpriteName));const d=await Promise.all(p);let g=0;const m=d[g++],r=l?d[g++]:void 0,e=f?d[g++]:void 0,n=t.projSpriteName?d[g++]:void 0;let a;const o=t.renderHints.includes("RENDER_LOADED_MISSILES")||t.renderHints.includes("RENDER_LOADED_MISSILES_UNLESS_HIDDEN"),i=s?t.hardPointOffsets:t.turretOffsets;if(o&&i.length>0&&t.projSpriteName){a=[];for(let u=0;u<i.length;u+=2){const y=s?i[u]-m.naturalHeight/4:i[u];a.push([y,i[u+1]])}}const S=[];if(r&&S.push(I(r)),e&&S.push(I(e)),S.push(I(m)),a&&a.length>0&&n)for(const u of a)S.push({element:n,centerOffsetX:0,centerOffsetY:0,translateX:u[1],translateY:u[0],degree:0});return M(...S)}async function O(t){var p,d,g,m;const s=await c.getImage(t.sprite);let l=[];for(const[r,e]of t.weaponIdMap.entries())if(e){const n=c.getWeaponById(e),a=t.allWeaponSlots.find(o=>o.id===r);if(n&&a){const o=await c.getWeaponCanvas(n,a.hardPoint);o&&l.push([a,o])}}l=l.sort((r,e)=>{const n=r[0].location,a=e[0].location;return n.x!==a.x?Math.abs(n.x)-Math.abs(a.x):Math.abs(n.y)-Math.abs(a.y)});let f=[];if(t.station){for(const[r,e]of t.moduleIdMap.entries())if(e){const n=c.getShipById(e),a=t.allWeaponSlots.find(o=>o.id===r);if(n&&a){const o=await c.getShipCanvas(n);f.push([n,a,o])}}f=f.sort((r,e)=>{const n=r[0],a=e[0];if(n.isUnderParent()!==a.isUnderParent())return n.isUnderParent()?-1:1;if(n.isEmptyModule()!==a.isEmptyModule())return n.isEmptyModule()?-1:1;const o=r[1].location,i=e[1].location;return o.x!==i.x?Math.abs(i.x)-Math.abs(o.x):Math.abs(i.y)-Math.abs(o.y)})}const h=[];h.push({element:s,centerOffsetX:t.center.left-s.naturalWidth/2+((d=(p=t.moduleAnchor)==null?void 0:p.x)!=null?d:0),centerOffsetY:t.center.bottom-s.naturalHeight/2+((m=(g=t.moduleAnchor)==null?void 0:g.y)!=null?m:0),translateX:0,translateY:0,degree:0});for(const r of l){const e=r[1],n=r[0],a=e.top+e.bottom,o=e.left+e.right;h.push({element:{naturalHeight:a,naturalWidth:o},centerOffsetX:e.left-o/2,centerOffsetY:-(e.top-a/2),translateX:n.location.x,translateY:n.location.y,degree:n.angle})}for(const r of f){const e=r[2],n=r[1],a=e.top+e.bottom,o=e.left+e.right;h.push({element:{naturalHeight:a,naturalWidth:o},centerOffsetX:e.left-o/2,centerOffsetY:-(e.top-a/2),translateX:n.location.x,translateY:n.location.y,degree:n.angle})}return M(...h)}export{E as a,O as c,D as d,x as r};
