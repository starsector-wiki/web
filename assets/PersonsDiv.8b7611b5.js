import{u as Y,Q as I,a as V}from"./use-quasar.e16a694c.js";import{Q as k}from"./QBtn.3bea4207.js";import{E as Q,r as C,a as h,H as v,W as g,Y as o,K as E,J as f,P as O,O as F,_ as p,$ as D,Z as R,L as S,I as M,X as U,a0 as q,av as z}from"./index.f106f705.js";const H={key:0,class:"filter-toolbar"},J={class:"filter-row"},K={class:"filter-group"},T={class:"filter-item"},W={class:"filter-item"},X={key:1,class:"result-count"},Z={class:"card-item-list-page"},j={class:"card-item-content"},G=["src"],ue=Q({name:"PersonsDiv",__name:"PersonsDiv",props:{personValues:{},hiddenOptions:{type:Boolean,default:!1}},setup(_){const x=Y(),r=C([]),c=C([]),N=[{label:"\u662F",value:"Y"},{label:"\u5426",value:"N"}],w=[{label:"\u662F",value:"Y"},{label:"\u5426",value:"N"}],B=h(()=>_.personValues.map(a=>typeof a=="string"?q.getPersonById(a):a).filter(a=>a!==void 0).sort(z)),b=h(()=>{let a=B.value;return r.value&&r.value.length>0&&(a=a.filter(l=>r.value.every(e=>y(l,e)))),c.value&&c.value.length>0&&(a=a.filter(l=>!c.value.some(e=>y(l,e)))),a}),L=h(()=>$(b.value,r.value,c.value)),P=h(()=>$(b.value,c.value,r.value));function $(a,l,e){const n=[],A=new Map;for(const t of B.value)A.set(t.factionId,{id:t.factionId,name:t.faction.displayName});return Array.from(A.values()).sort((t,u)=>t.name.localeCompare(u.name)).forEach(t=>{const u=`faction:${t.id}`,s=a.filter(i=>i.factionId===t.id).length,d=l&&l.includes(u),m=e&&e.includes(u);n.push({label:`[\u52BF\u529B] ${t.name}(${s})`,value:u,chipLabel:`[\u52BF\u529B] ${t.name}`,disable:!d&&s===0||m})}),N.forEach(t=>{const u=`isDefault:${t.value}`,s=t.value==="Y"?a.filter(i=>i.defaults).length:a.filter(i=>!i.defaults).length,d=l&&l.includes(u),m=e&&e.includes(u);n.push({label:`[\u662F\u5426\u4E3A\u9ED8\u8BA4] ${t.label}(${s})`,value:u,chipLabel:`[\u662F\u5426\u4E3A\u9ED8\u8BA4] ${t.label}`,disable:!d&&s===0||m})}),w.forEach(t=>{const u=`isAi:${t.value}`,s=t.value==="Y"?a.filter(i=>Boolean(i.aiCore)).length:a.filter(i=>!i.aiCore).length,d=l&&l.includes(u),m=e&&e.includes(u);n.push({label:`[\u662F\u5426\u4E3AAI\u6838\u5FC3] ${t.label}(${s})`,value:u,chipLabel:`[\u662F\u5426\u4E3AAI\u6838\u5FC3] ${t.label}`,disable:!d&&s===0||m})}),n}function y(a,l){const[e,n]=l.split(":");return e==="faction"?a.factionId===n:e==="isDefault"?n==="Y"?a.defaults:!a.defaults:e==="isAi"?n==="Y"?Boolean(a.aiCore):!a.aiCore:!1}return(a,l)=>(v(),g(D,null,[_.hiddenOptions?F("",!0):(v(),g("div",H,[o("div",J,[o("div",K,[o("div",T,[l[2]||(l[2]=o("div",{class:"filter-item-label"},"\u5305\u542B\u6761\u4EF6",-1)),E(I,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e),options:L.value,multiple:"","emit-value":"","map-options":"","use-chips":"",dense:"","options-dense":"",behavior:O(x).screen.lt.sm?"dialog":"menu",clearable:"","clear-icon":"close",placeholder:"\u9009\u62E9\u9700\u8981\u5305\u542B\u7684\u6761\u4EF6"},{"selected-item":f(e=>[E(V,{removable:"",dense:"",onRemove:n=>e.removeAtIndex(e.index),tabindex:e.tabindex,color:"primary","text-color":"white"},{default:f(()=>[S(p(e.opt.chipLabel||e.opt.label),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","behavior"])]),o("div",W,[l[3]||(l[3]=o("div",{class:"filter-item-label"},"\u6392\u9664\u6761\u4EF6",-1)),E(I,{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e),options:P.value,multiple:"","emit-value":"","map-options":"","use-chips":"",dense:"","options-dense":"",behavior:O(x).screen.lt.sm?"dialog":"menu",clearable:"","clear-icon":"close",placeholder:"\u9009\u62E9\u9700\u8981\u6392\u9664\u7684\u6761\u4EF6"},{"selected-item":f(e=>[E(V,{removable:"",dense:"",onRemove:n=>e.removeAtIndex(e.index),tabindex:e.tabindex,color:"negative","text-color":"white"},{default:f(()=>[S(p(e.opt.chipLabel||e.opt.label),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","behavior"])])])])])),_.hiddenOptions?F("",!0):(v(),g("div",X," \u5171 "+p(b.value.length)+" \u4E2A\u7ED3\u679C ",1)),o("div",Z,[(v(!0),g(D,null,R(b.value,e=>(v(),M(k,{class:"card-item","no-caps":"",key:e.id,to:{name:"person",params:{id:e.id}}},{default:f(()=>[o("div",j,[o("img",{decoding:"async",src:e.portraitSprite},null,8,G),o("span",{style:U({color:"#"+e.faction.color})},p(e.firstName)+" "+p(e.lastName),5)])]),_:2},1032,["to"]))),128))])],64))}});export{ue as _};
