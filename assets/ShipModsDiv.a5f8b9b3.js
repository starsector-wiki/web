import{u as R,Q as O,a as T}from"./use-quasar.e16a694c.js";import{Q as q}from"./QBtn.3bea4207.js";import{E as F,r as A,a as g,H as v,W as b,Y as i,K as B,J as f,P as I,O as w,_,$ as D,Z as H,L,I as J,a0 as K,ao as P}from"./index.f106f705.js";const W={key:0,class:"filter-toolbar"},Y={class:"filter-row"},Z={class:"filter-group"},j={class:"filter-item"},z={class:"filter-item"},G={key:1,class:"result-count"},X={class:"card-item-list-page"},M={class:"card-item-content"},ee={style:{margin:"auto"}},le=["src"],se=F({name:"ShipModsDiv",__name:"ShipModsDiv",props:{shipModValues:{},hiddenOptions:{type:Boolean,default:!1}},setup(E){const x=R(),d=A([]),c=A([]),k=[{label:"\u666E\u901A",value:"normal"},{label:"D\u63D2\u4EF6",value:"dmod"},{label:"\u9690\u85CF",value:"hidden"}],y=g(()=>E.shipModValues.map(t=>typeof t=="string"?K.getShipModById(t):t).filter(t=>t!==void 0).sort(P)),h=g(()=>{let t=y.value;return d.value&&d.value.length>0&&(t=t.filter(n=>d.value.every(e=>$(n,e)))),c.value&&c.value.length>0&&(t=t.filter(n=>!c.value.some(e=>$(n,e)))),t}),Q=g(()=>V(h.value,d.value,c.value)),U=g(()=>V(h.value,c.value,d.value));function V(t,n,e){const s=[];k.forEach(l=>{const a=`type:${l.value}`;let u=0;l.value==="dmod"?u=t.filter(o=>o.tags.includes("dmod")).length:l.value==="hidden"?u=t.filter(o=>o.hidden).length:l.value==="normal"&&(u=t.filter(o=>!o.hidden&&!o.tags.includes("dmod")).length);const r=n&&n.includes(a),m=e&&e.includes(a);s.push({label:`[\u7C7B\u578B] ${l.label}(${u})`,value:a,chipLabel:`[\u7C7B\u578B] ${l.label}`,disable:!r&&u===0||m})});const p=y.value.flatMap(l=>l.uiTags).filter(l=>typeof l=="string"&&l.length>0).sort();return Array.from(new Set(p)).forEach(l=>{const a=`uiTag:${l}`,u=t.filter(o=>o.uiTags.includes(l)).length,r=n&&n.includes(a),m=e&&e.includes(a);s.push({label:`[UI\u6807\u7B7E] ${l}(${u})`,value:a,chipLabel:`[UI\u6807\u7B7E] ${l}`,disable:!r&&u===0||m})}),Array.from(new Set(y.value.map(l=>{var a;return(a=l.manufacturer)!=null?a:null}))).sort((l,a)=>{const u=l!=null?l:"",r=a!=null?a:"";return u.localeCompare(r)}).forEach(l=>{const a=l&&l.length>0?l:"\u672A\u77E5",u=`manufacturer:${l!=null?l:"null"}`,r=t.filter(N=>{var C;return((C=N.manufacturer)!=null?C:null)===l}).length,m=n&&n.includes(u),o=e&&e.includes(u);s.push({label:`[\u8BBE\u8BA1\u7C7B\u578B] ${a}(${r})`,value:u,chipLabel:`[\u8BBE\u8BA1\u7C7B\u578B] ${a}`,disable:!m&&r===0||o})}),s}function $(t,n){var p;const[e,s]=n.split(":");if(e==="type"){if(s==="dmod")return t.tags.includes("dmod");if(s==="hidden")return t.hidden;if(s==="normal")return!t.hidden&&!t.tags.includes("dmod")}else{if(e==="uiTag")return t.uiTags.includes(s);if(e==="manufacturer"){const S=s==="null"?null:s;return((p=t.manufacturer)!=null?p:null)===S}}return!1}return(t,n)=>(v(),b(D,null,[E.hiddenOptions?w("",!0):(v(),b("div",W,[i("div",Y,[i("div",Z,[i("div",j,[n[2]||(n[2]=i("div",{class:"filter-item-label"},"\u5305\u542B\u6761\u4EF6",-1)),B(O,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),options:Q.value,multiple:"","emit-value":"","map-options":"","use-chips":"",dense:"","options-dense":"",behavior:I(x).screen.lt.sm?"dialog":"menu",clearable:"","clear-icon":"close",placeholder:"\u9009\u62E9\u9700\u8981\u5305\u542B\u7684\u6761\u4EF6"},{"selected-item":f(e=>[B(T,{removable:"",dense:"",onRemove:s=>e.removeAtIndex(e.index),tabindex:e.tabindex,color:"primary","text-color":"white"},{default:f(()=>[L(_(e.opt.chipLabel||e.opt.label),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","behavior"])]),i("div",z,[n[3]||(n[3]=i("div",{class:"filter-item-label"},"\u6392\u9664\u6761\u4EF6",-1)),B(O,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),options:U.value,multiple:"","emit-value":"","map-options":"","use-chips":"",dense:"","options-dense":"",behavior:I(x).screen.lt.sm?"dialog":"menu",clearable:"","clear-icon":"close",placeholder:"\u9009\u62E9\u9700\u8981\u6392\u9664\u7684\u6761\u4EF6"},{"selected-item":f(e=>[B(T,{removable:"",dense:"",onRemove:s=>e.removeAtIndex(e.index),tabindex:e.tabindex,color:"negative","text-color":"white"},{default:f(()=>[L(_(e.opt.chipLabel||e.opt.label),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","behavior"])])])])])),E.hiddenOptions?w("",!0):(v(),b("div",G," \u5171 "+_(h.value.length)+" \u4E2A\u7ED3\u679C ",1)),i("div",X,[(v(!0),b(D,null,H(h.value,e=>(v(),J(q,{class:"card-item",style:{"align-self":"stretch"},"no-caps":"",key:e.id,to:{name:"ship_mod",params:{id:e.id}}},{default:f(()=>[i("div",M,[i("div",ee,[i("img",{decoding:"async",src:e.icon},null,8,le)]),i("span",null,_(e.name),1)])]),_:2},1032,["to"]))),128))])],64))}});export{se as _};
